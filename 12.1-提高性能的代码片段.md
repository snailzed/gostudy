# 提高性能的代码片段

## 1、字符串相关

- 修改字符串字符
  
     
     str := "Hello"
     strB := []byte(str)
     strB[0] = 'u'
     str = string(strB)
     
- 获取字符串子串

     
     str[m:n]     
     

- 获取字符数
  
     
     utf8.RuneCountInString(str) //最快速
     len([]rune(str))
          
- 获取字节数

     
      len(str)   
      
- 连接字符串
 
      bytes.Buffer //最快速
      strings.Join()
      str += str1// +
      
```go
var buffer bytes.Buffer
for {
	if s, ok := getNextString(); ok { //method getNextString() not shown here
		buffer.WriteString(s)
	} else {
		break
	}
}
fmt.Print(buffer.String(), "\n")
```      
     
## 2、map字典

  
    var,exists := map1[key1]/检测key是否存在
    delete(map1,key1)                  //删除一个key
    
## 3、结构体
> 推荐使用函数返回实例

```go
      type A struct {
      
      }
      
      func NewA() *A{
        return &A{}
      }    
```

## 4、接口

- 检测是否实现了某个接口

       var,ok := t.(T) 

- `switch-type`
```go
func classifier(items ...interface{}) {
    for i, x := range items {
        switch x.(type) {
        case bool:
            fmt.Printf("param #%d is a bool\n", i)
        case float64:
            fmt.Printf("param #%d is a float64\n", i)
        case int, int64:
            fmt.Printf("param #%d is an int\n", i)
        case nil:
            fmt.Printf("param #%d is nil\n", i)
        case string:
            fmt.Printf("param #%d is a string\n", i)
        default:
            fmt.Printf("param #%d’s type is unknown\n", i)
        }
    }
}
```

## 5、读写文件

```go
func cat(f *file.File) {
  const NBUF = 512
  var buf [NBUF]byte
  for {
    switch nr, er := f.Read(buf[:]); true {
    case nr < 0:
      fmt.Fprintf(os.Stderr, "cat: error reading from %s: %s\n",
        f.String(), er.String())
      os.Exit(1)
    case nr == 0: // EOF
      return
    case nr > 0:
      if nw, ew := file.Stdout.Write(buf[0:nr]); nw != nr {
        fmt.Fprintf(os.Stderr, "cat: error writing from %s: %s\n",
          f.String(), ew.String())
      }
    }
  }
}
```
